<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Redirecting…</title>
</head>
<body>
<div style="width: 100%;height: 100%;">
	<div>
		<input type="password" id="pw">
		<button type="button" id="go" >Submit</button>
	</div>
</div>

<script>

function buildRedirectURL( pw )
{
	const url = new URL( window.location.href );

	url.search = '';
	url.hash = '';
	
	
	let path = url.pathname;
	const splitted = path.split(/\/+/).filter( item => item.length );
	if( ! path.endsWith( '/' ) ){ splitted.pop(); }	// 末尾が / じゃない場合はファイルパス
	
	const sesame = Number.parseInt( Number.parseInt( pw ) * Math.PI * 1e12 );
	splitted.push( encodeURIComponent( sesame ) );
	
	// パスセグメントとしてエンコードして付与
	url.pathname = splitted.join('/') + '/';

	return url.toString();
}

function redirect()
{
	const input = document.getElementById( 'pw' );
	const pw = input.value.trim();
	if( ! pw )
	{
		input.focus();
		return;
	}
	window.location.href = buildRedirectURL( pw );
}

document.getElementById( 'go' ).addEventListener( 'click', redirect );
document.getElementById( 'pw' ).addEventListener( 'keydown', ( e ) =>
{
	if( e.key === 'Enter' )
	{
		redirect();
	}
});

</script>
</body>
</html>
